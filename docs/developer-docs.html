<head>
  <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
  <style>
    .caret {
      cursor: pointer;
      -webkit-user-select: none; /* Safari 3.1+ */
      -moz-user-select: none; /* Firefox 2+ */
      -ms-user-select: none; /* IE 10+ */
      user-select: none;
    }

    .caret::before {
      content: "\25B6";
      color: black;
      display: inline-block;
      margin-right: 6px;
    }

    .caret-down::before {
      -ms-transform: rotate(90deg); /* IE 9 */
      -webkit-transform: rotate(90deg); /* Safari */'
      transform: rotate(90deg);  
    }

    .nested {
      display: none;
    }

    .active {
      display: block;
    }

    a{
      color: blue;
      text-decoration: underline;
    }

    .banner{
      background-image: url("https://clincoln8.github.io/evosuite-plus-plus/imgs/banner.png");
      background-size: contain;
      text-align: center;
      padding: 4vh;
      vertical-align: middle; 
      background-color: rgba(255, 255, 255, 0.3);
      background-blend-mode: overlay;

    }
  </style>
</head>

<body class="min-h-screen flex flex-col justify-between bg-gray-50">

  <!--  Separate rest of page from footer  -->
  <div>
    <!--  Top Title    -->
    <div class="inline-flex p-4">
      <img src="https://img.icons8.com/metro/50/000000/search.png"/>
      <h1 class="font-medium leading-tight text-2xl mt-2 mb-2 pl-4">EvoObj Dev Docs</h1>
    </div>

    <!--   Banner   -->
    <div class="banner">
      <h1 class="font-bold leading-tight text-5xl ">	EvoObj & EvoSuite Developer Documentation</h1>
      <br><p>Documentation for how EvoObj works under the hood.</p>
    </div>

    <!--  Page Content  -->
    <div class="p-2">

      <!--  Intro Text    -->
      <div>
        <p>
          This site is to provide developer documentation for <a href="https://sites.google.com/view/evoobj/home">EvoObj</a> [1] and by extension <a href="https://www.evosuite.org/">EvoSuite</a> [2]. This site has been created for educational purposes only and is in no way endorsed or acknowledge by EvoObj nor EvoSuite.
        </p>
      </div>

      <!--  EvoSuite Workflow    -->
      <div class="pt-4 flex flex-col space-y-4">
        <button type="button" id="expand-all" class="w-1/6 bg-blue-400 hover:bg-blue-700 border border-gray-400 text-white font-bold text-m py-2 px-4 rounded-full shadow">Expand All</button>

        <!-- Workflow is added to this div via JS  -->
        <div id="root" class="flex justify-evenly"></div>
      </div>
    </div>
  </div>

  <!--  Footer  -->
  <footer class="flex-col justify-end border ">
    <div class="bg-gray-100 text-center">
      <p class="text-xs">
        <a href="https://icons8.com/icon/131/search">Search icon by Icons8</a>

      </p>
    </div>
  </footer>
</body>
<script>

  const evoObjModClass = ["bg-yellow-200"];
  const evoObjAddClass = ["bg-orange-200"];

  const master = {
    title: '<a href="https://github.com/llmhyy/evosuite-plus-plus/tree/master/client">/master</a>',
    description: 'description here',
    children: [
      {
        function: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/master/src/main/java/org/evosuite/EvoSuite.java#L317">Evosuite.java</a>',
        nodes: [
          {
            title: '<a href="">TestGeneration</a>',
            description: 'todo',
            spanClass: "evoobj-add",
            children: [
              { 
                function: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/master/src/main/java/org/evosuite/executionmode/TestGeneration.java#L56">executeTestGeneration()</a>',
                nodes:[ 
                  {
                    title: '',
                    description: 'Instantiates ClientNodeImpl and startsNewSearch (see client side)',
                    children: [],
                  }]},]}]},]};
  const depAnalysisChildren = [{
    function: '',
    nodes:[
      { 
        title: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/setup/DependencyAnalysis.java#L81">initInheritanceTree()</a>',
        description: 'insert here',
        children:[],
      },
      { 
        title: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/setup/DependencyAnalysis.java#L89">analyze()</a>',
        description: 'insert here',
        children:[],
      },
      { 
        title: 'InterproceduralGraphAnalysis',
        description: '* <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/setup/DependencyAnalysis.java#L152">Passes</a> a <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/graphs/interprocedural/interestednode/OCGInterestedNodeFilter.java">OCGInterestedNodeFilter</a> when EvoObj is enabled (-Dapply_object_rule==true) to ',
        spanClass: evoObjAddClass,
        children:[
          {function: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/graphs/interprocedural/InterproceduralGraphAnalysis.java#L66">initialzeDataflow()',
           nodes:[
             { 
               title: 'Todo',
               description: '***',
               children:[],
             }]}],}]}];

  const searchAlgoNodes = [{ 
    title: 'Builds a genetic algorithm.',
    description: `<a href=""https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/strategy/PropertiesSuiteGAFactory.java#L102">getChromosomeFactory()</a> uses Properties.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/Properties.java#L1298">TEST_FACTORY</a> and returns an <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/ga/archive/ArchiveTestChromosomeFactory.java#L35">ArchiveTestChromosomeFactory</a> by default.

    <br><br><a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/strategy/PropertiesSuiteGAFactory.java#L139">getGeneticAlgorithm()</a> uses Properties.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/c2ea99f2e7f55ae4e04ebeca1e3d588842982b3c/client/src/main/java/org/evosuite/Properties.java#L394">ALGORITHM</a> returns <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/ga/metaheuristics/MonotonicGA.java#L74">MonotonicGA</a> by default, initialized with the ChromosomeFactory from above.

    <br><br><a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/strategy/PropertiesSuiteGAFactory.java#L249">getSelectionFunction()</a> uses Properties.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/Properties.java#L706">SELECTION_FUNCTION</a> and returns <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/ga/operators/selection/RankSelection.java#L34">RankSelection</a> by default. 

    <br><br><a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/strategy/PropertiesSuiteGAFactory.java#L290">getRankingFunction()</a> uses Properties.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/Properties.java#L391">RANKING_TYPE</a> and returns <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/ga/operators/ranking/RankBasedPreferenceSorting.java#L41">RankBasedPreferenceSorting</a> by default.


    <br><br><a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/strategy/PropertiesSuiteGAFactory.java#L268">getCrossoverFunction()</a> uses Properties.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/Properties.java#L674">CROSSOVER_FUNCTION</a> and returns <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/ga/operators/crossover/SinglePointRelativeCrossOver.java#L31">SinglePointRelativeCrossOver</a> by default.

    <br><br><a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/testsuite/secondaryobjectives/TestSuiteSecondaryObjective.java#L36">setSecondaryObjectives()</a> adds each Properties.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/Properties.java#L724">SECONDARY_OBJECTIVE</a>, to the <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/testsuite/TestSuiteChromosome.java#L51">TestSuiteChromosome</a>. <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/testsuite/secondaryobjectives/MinimizeTotalLengthSecondaryObjective.java#L30">MinimizeTotalLengthSecondaryObjective</a> is added by default.

   <br><br><a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/strategy/PropertiesSearchAlgorithmFactory.java#L64">getStoppingCondition()</a> uses Properties.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/Properties.java#L667">STOPPING_CONDITION</a> and returns MaxTimeStoppingCondition by default.

   <br><br><a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/strategy/PropertiesSearchAlgorithmFactory.java#L51">getPopulationLimit()</a> uses Properties.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/Properties.java#L644">POPULATION_LIMIT</a> and returns <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/ga/populationlimit/IndividualPopulationLimit.java#L36">IndividualPopulationLimit</a> by default.`,
    children:[],
  }];

  const initPopulation = [
    {
      function: 'calls <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/ga/metaheuristics/GeneticAlgorithm.java#L386">generateInitialPopulation()</a> --> <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/ga/metaheuristics/GeneticAlgorithm.java#L441">generateRandomPopulation()</a>',
      nodes:[
        {
          title: 'ArchiveTestChromosomeFactory',
          description: 'By default when Properties.STRATEGY==EVOSUITE, this Chromosome Factory type will be created (see above PropertiesSuiteGAFactory node above for details). ',
          children:[
            {
              function: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/ga/archive/ArchiveTestChromosomeFactory.java#L57">getChromosome()</a>',
              nodes:[
                { 
                  title: 'RandomLengthTestFactory',
                  description: 'This is <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/ga/archive/ArchiveTestChromosomeFactory.java#L88">called</a> by above given certain conditions.',
                  children:[
                    {
                      function: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/testcase/factories/RandomLengthTestFactory.java#L267">getChromosome()</a>',
                      nodes:[
                        { 
                          title: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/testcase/factories/RandomLengthTestFactory.java#L83">getRandomTestCase()</a>',
                          description: 'This was modified by EvoObj in order to use the previously initialized InterproceduralGraphAnalysis.',
                          children:[],
                          spanClass: evoObjModClass,
                        },
                        { 
                          title: 'TestChromosome <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/testcase/TestChromosome.java#L102">setTestCase()</a>',
                          description: 'Initializes <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/testcase/TestChromosome.java#L63">TestChromosome</a> with the generated test case.',
                          children:[],
                        },]},],}]}],},
        { 
          title: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/ga/Chromosome.java#L164">addFitness()</a>',
          description: 'Associates each chromosome with the fitness functions.',
          children:[],
        }

      ]},

    {
      function: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/ga/metaheuristics/GeneticAlgorithm.java#L666">calculateFitnessAndSortPopulation()</a><br><br>Cacluclates, then sorts the population',
      nodes:[]
    },
  ];


  const client = {
    title: '<a href="https://github.com/llmhyy/evosuite-plus-plus/tree/master/client">/client</a>',
    description: 'description here<br>Client side is initiated when  TestGeneration.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/master/src/main/java/org/evosuite/executionmode/TestGeneration.java#L213">generateTests()</a> in /master instantiates a ClientNodeImpl object which',
    children: [
      {function: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/master/src/main/java/org/evosuite/executionmode/TestGeneration.java#L509">calls</a> <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/rmi/service/ClientNodeImpl.java#L134">startNewSearch()</a>', 
       nodes: [
         {title: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/rmi/service/ClientNodeImpl.java#L157">calls</a> TestSuiteGenerator.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/TestSuiteGenerator.java#L139">generateTestSuite()</a>',
          description: 'this function',
          children:[
            {function: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/TestSuiteGenerator.java#L183">calls</a> <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/TestSuiteGenerator.java#L104">initializeTargetClass()</a>',
             nodes: [{
               title: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/TestSuiteGenerator.java#L107">calls</a> <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/TestSuiteGenerator.java#L376">buildLoadTargetClassTestCase()</a>',
               description: '* Creates a single <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/testcase/DefaultTestCase.java#L76">DefaultTestCase</a> that only loads the target class.',
               children:[],
             },
                     {
                       title: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/TestSuiteGenerator.java#L108">runs</a> TestCaseExecutor.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/d54090d6e65d4ba2d2296dc859e7ee2480f92459/client/src/main/java/org/evosuite/testcase/execution/TestCaseExecutor.java#L275">execute()</a>',
                       description: '* Runs the dummy test to <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/TestSuiteGenerator.java#L110">check</a> for failures.',
                       children:[],
                     },
                     {
                       title: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/TestSuiteGenerator.java#L127">calls</a> DependencyAnalysis.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/setup/DependencyAnalysis.java#L134">analyzeClass()</a>',
                       description: '',
                       children: depAnalysisChildren,
                     },

                    ]},
            {
              function: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/TestSuiteGenerator.java#L708">generateTests()</a>',
              nodes:[
                { 
                  title: '<a href="https://github.com/llmhyy/evosuite-plus-plus/tree/master/client/src/main/java/org/evosuite/strategy">TestGenerationStrategy</a>',
                  description: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/TestSuiteGenerator.java#L718">returned</a> from TestSuiteGeneratorHelper.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/TestSuiteGeneratorHelper.java#L252">getTestGenerationStrategy()</a>. The following assumes that <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/Properties.java#L1614">Properties.STRATEGY</a> is set to EVOSUITE (default), which will set the strategy to <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/strategy/WholeTestSuiteStrategy.java#L54">WholeTestSuiteStrategy</a>',
                  children:[
                    {function: 'strategy.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/strategy/WholeTestSuiteStrategy.java#L57">generateTests</a>()',
                     nodes: [
                       { 
                         title: 'PropertiesSuiteGAFactory',
                         description: '',
                         children:[
                           {function: 'algorithmFactory.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/strategy/PropertiesSuiteGAFactory.java#L305">getSearchAlgorithm()</a>',
                            nodes: searchAlgoNodes,
                           },
                         ],
                       },
                       { title: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/strategy/TestGenerationStrategy.java#L86">getFitnessFunctions()</a>',
                        description: 'Sets fitness functions with a helper method FitnessFunctions.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/coverage/FitnessFunctions.java#L113">getFitnessFunction()</a> based on Properties.<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/Properties.java#L1494">CRITERION</a> list.',
                        children:[],
                       },
                       { 
                         title: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/strategy/WholeTestSuiteStrategy.java#L174">getGoals()</a>',
                         description: `* Initializes fitness factories via helper <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/coverage/FitnessFunctions.java#L180">getFitnessFactory()</a> based on Properties.CRITERION.
                  <br><br>* Gets coverage goals from each factory; <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/coverage/method/MethodCoverageFactory.java#L60">example</a>`,
                         children:[],
                       }  ,           
                       { 
                         title: 'MonotonicGA',
                         description: "given the necessary flags, this will be the algorithm created above by the PropertiesSuiteGAFactory",
                         children:[
                           {
                             function: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/c2ea99f2e7f55ae4e04ebeca1e3d588842982b3c/client/src/main/java/org/evosuite/ga/metaheuristics/MonotonicGA.java#L282">generateSolution()</a>',
                             nodes:[
                               { 
                                 title: '<a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/ga/metaheuristics/MonotonicGA.java#L263">initializePopulation()</a>',
                                 description: 'Initializes a population as a list of <a href="https://github.com/llmhyy/evosuite-plus-plus/blob/master/client/src/main/java/org/evosuite/testcase/TestChromosome.java#L63">Test Chromosomes</a> of length Properties.POPULATION ',
                                 children: initPopulation,
                               },
                               { 
                                 title: 'todo',
                                 description: '* updatePopulation, evolve, sort, get best...',
                                 children:[],
                               } ]},],}
                     ],}]
                },

              ]},]}]},
      {
        function: 'test()',
        nodes:[
          { 
            title: 'testing',
            description: 'insert here',
            children:[],
          }]}]};

  function getLi(content){

    const title = document.createElement("span");
    title.innerHTML = content.title;


    if (content.children.length){
      title.classList.add("caret");
    }

    const desc = document.createElement("p");
    desc.innerHTML = content.description

    const li = document.createElement("li");
    li.appendChild(title);
    li.appendChild(desc);          
    li.classList.add("box-border", "p-4", "border-4");
    if ('spanClass' in content){
      li.classList.add(...content.spanClass);
    }
    return li
  }

  function constructTree(content){
    const li = getLi(content)
    console.log(li)
    if (!content.children.length){
      return li;
    }

    const subUl = document.createElement("ul");

    for (let child of content.children) {

      const func = document.createElement("li");
      func.innerHTML = child.function;
      subUl.appendChild(func)
      subUl.classList.add("nested")

      const subClass = document.createElement("li");
      for (let node of child.nodes) {
        const ul = document.createElement("ul");
        ul.appendChild(constructTree(node))
        subClass.appendChild(ul)
      }
      subUl.appendChild(subClass)
    }
    li.append(subUl)
    console.log(li)
    return li
  }

  const masterElem = document.createElement("ul");
  // masterElem.append(...constructTree(master).childNodes)
  masterElem.append(constructTree(master))
  const clientElem = document.createElement("ul");
  // clientElem.append(...constructTree(client).childNodes)
  clientElem.append(constructTree(client))
  const root = document.getElementById("root");
  root.appendChild(masterElem);
  root.appendChild(clientElem);


  console.log(document.querySelectorAll(".caret"))
  document.querySelectorAll(".caret").forEach((elem)=> {
    elem.addEventListener("click", function() {      this.parentElement.querySelector(".nested").classList.toggle("active");
                                               this.classList.toggle("caret-down");
                                              });
  })

  document.getElementById("expand-all").addEventListener("click", function() {
    document.querySelectorAll('.nested').forEach((elem)=> {

      elem.classList.add("active");
    });
    document.querySelectorAll('.caret').forEach((elem)=> elem.classList.add("caret-down"));

  });

  function resizeIFrameToFitContent( iFrame ) {

    iFrame.width  = iFrame.contentWindow.document.body.scrollWidth;
    iFrame.height = iFrame.contentWindow.document.body.scrollHeight;
  }

  window.addEventListener('DOMContentLoaded', function(e) {

    var iFrame = document.getElementById( 'userHtmlFrame' );
    if (iFrame){
      resizeIFrameToFitContent( iFrame );
    }

  } );
</script>
